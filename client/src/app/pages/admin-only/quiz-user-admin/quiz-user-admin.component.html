<div class="container-top">
  <h2 class="page-title">üìä Danh s√°ch k·∫øt qu·∫£ quiz c·ªßa ng∆∞·ªùi d√πng</h2>

  <div *ngIf="isLoading" class="loading">
    <p>ƒêang t·∫£i d·ªØ li·ªáu...</p>
  </div>

  <div *ngIf="!isLoading && allResults.length > 0" class="results-container">
    <table class="results-table">
      <thead>
        <tr>
          <th>#</th>
          <th>ID User</th>
          <th>Ng√†y l√†m</th>
          <th>S·ªë c√¢u</th>
          <th>T·ªïng ƒëi·ªÉm</th>
          <th>Chi ti·∫øt</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of allResults; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ item.idUser }}</td>
          <td>{{ item.dateDoQuiz | date: "short" }}</td>
          <td>{{ item.totalQuestions }}</td>
          <td>{{ item.totalScore }}</td>
          <td>
            <button
              class="view-btn"
              (click)="openDetail(item.idUser, item.dateDoQuiz)"
            >
              üëÅÔ∏è
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!isLoading && allResults.length === 0" class="no-results">
    Kh√¥ng c√≥ k·∫øt qu·∫£ n√†o ƒë∆∞·ª£c t√¨m th·∫•y.
  </div>
</div>

<!-- Modal hi·ªÉn th·ªã chi ti·∫øt -->
<div *ngIf="showDetailModal" class="modal-overlay">
  <div class="modal-content">
    <h3>Chi ti·∫øt quiz c·ªßa user: {{ selectedUser }}</h3>
    <button class="close-btn" (click)="closeDetail()">ƒê√≥ng</button>

    <!-- Danh s√°ch c√°c c·ª•c quiz -->
    <div class="quiz-bubbles">
      <div
        *ngFor="let quiz of quizzes; let i = index"
        class="quiz-bubble"
        [ngClass]="[
          quiz.result ? 'correct' : 'incorrect',
          selectedQuiz === quiz ? 'active' : '',
        ]"
        (click)="selectQuiz(i)"
      >
        {{ i + 1 }}
      </div>
    </div>

    <!-- Chi ti·∫øt 1 c√¢u quiz -->
    <div *ngIf="selectedQuiz" class="quiz-detail-box">
      <h4>
        <strong>{{ selectedQuiz.quiz?.quizName || "T√™n quiz" }}</strong>
      </h4>
      <p>
        <strong>C√¢u h·ªèi:</strong> {{ selectedQuiz.quiz?.question || "..." }}
      </p>
      <p>
        <strong>ƒê√°p √°n ƒë√£ ch·ªçn:</strong>
        {{ selectedQuiz.chooseAnswer || "..." }}
      </p>
      <p>
        <strong>K·∫øt qu·∫£:</strong>
        {{ selectedQuiz.result ? "‚úÖ ƒê√∫ng" : "‚ùå Sai" }}
      </p>
    </div>

    <div *ngIf="quizzes.length === 0">Kh√¥ng c√≥ chi ti·∫øt quiz n√†o.</div>
  </div>
</div>
